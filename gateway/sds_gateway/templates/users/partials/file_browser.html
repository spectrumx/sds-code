<!-- Selection Button -->
<div class="input-group mb-3">
    <button type="button"
            class="btn btn-outline-secondary"
            data-bs-toggle="modal"
            data-bs-target="#fileTreeModal">
        <i class="bi bi-folder-plus"></i> Browse Files
    </button>
    <input type="text"
           class="form-control"
           id="selected-files-display"
           placeholder="0 file(s) selected"
           disabled />
</div>
<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">
            Select Files for Dataset: "<span class="dataset-name-display">Untitled Dataset</span>"
        </h5>
        {% if can_remove_assets %}
            <button type="button"
                    class="btn btn-danger"
                    id="remove-all-selected-files-button">Remove All</button>
        {% endif %}
    </div>
    <div class="card-body">
        <!-- Selected Files Table -->
        <div class="table-responsive">
            <table class="table table-striped table-hover" id="selected-files-table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Type</th>
                        <th>Path</th>
                        <th>Size</th>
                        <th>Owner</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="no-data-row">
                        <td colspan="6" class="text-center text-muted py-4">
                            No files selected. Click "Browse Files" to select files.
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<!-- File Tree Modal -->
<div class="modal fade"
     id="fileTreeModal"
     tabindex="-1"
     aria-labelledby="fileTreeModalLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="fileTreeModalLabel">Select Files</h5>
                <button type="button"
                        class="btn-close"
                        data-bs-dismiss="modal"
                        aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                    <!-- Search Form -->
                    <div class="mb-3" id="files-search-form">
                        <div class="row g-3">
                            <div class="col-12">
                                <div class="form-group">
                                    <label for="file-search" class="form-label">Search Files</label>
                                    <div class="input-group">
                                        <input type="text"
                                               class="form-control"
                                               id="file-name"
                                               name="file_name"
                                               placeholder="Enter file name..." />
                                        <input type="text"
                                               class="form-control"
                                               id="file-directory"
                                               name="directory"
                                               placeholder="Enter directory path..." />
                                        <select class="form-select"
                                                id="file-extension"
                                                name="file_extension"
                                                aria-label="File extension filter">
                                            <!-- Options will be dynamically populated by FileSearchForm -->
                                        </select>
                                        <button type="button" class="btn btn-primary" id="search-files">Search</button>
                                        <button type="button"
                                                class="btn btn-outline-secondary"
                                                id="clear-files-search">Clear</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="select-all-container" class="mt-1 mb-1">
                        <input class="form-check-input"
                               type="checkbox"
                               role="switch"
                               id="select-all-files-checkbox" />
                        <label class="form-check-label" for="select-all-files-checkbox">Select All Files</label>
                    </div>
                    <!-- File Tree Table with fixed height and scroll -->
                    <div class="table-responsive file-tree-container">
                        <table class="table table-striped" id="file-tree-table">
                            <thead class="sticky-top">
                                <tr>
                                    <th class="w-5"></th>
                                    <th class="w-30">Name</th>
                                    <th class="w-15">Type</th>
                                    <th class="w-20">Size</th>
                                    <th class="w-30">Created At</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="no-data-row">
                                    <td colspan="5" class="text-center text-muted py-4">
                                        <i class="bi bi-folder me-2"></i>
                                        Use the search form above to browse files
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div id="files-pagination" class="mt-3">
                        <!-- Pagination will be dynamically inserted here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button"
                        class="btn btn-primary"
                        id="confirm-file-selection"
                        data-bs-dismiss="modal">Confirm Selection</button>
            </div>
        </div>
    </div>
</div>
