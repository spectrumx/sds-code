{# templates/users/file_list.html #}
{% extends "base.html" %}

{% load static %}

{% block bodyclass %}
    hero-white-page
{% endblock bodyclass %}
{% block content %}
<style>
  .sidebar-filters {
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.06);
    padding: 2rem 1.5rem 1.5rem 1.5rem;
    margin-bottom: 2rem;
  }
  .sidebar-filters h2 {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 1.5rem;
  }
  .sidebar-filters .accordion-item {
    border: none;
    margin-bottom: 0.5rem;
    background: transparent;
  }
  .sidebar-filters .accordion-button {
    background: #f8f9fa;
    border-radius: 8px;
    font-weight: 500;
    font-size: 1.1rem;
    box-shadow: none;
    margin-bottom: 0.25rem;
    border: none;
    transition: background 0.2s, color 0.2s;
  }
  .sidebar-filters .accordion-button:not(.collapsed) {
    background: #e9ecef;
    color: #212529;
  }
  .sidebar-filters .accordion-body {
    background: #fff;
    border-radius: 0 0 8px 8px;
    padding-top: 0.75rem;
    padding-bottom: 0.75rem;
  }
  .sidebar-filters .btn {
    font-weight: 600;
    font-size: 1rem;
    border-radius: 8px;
    padding: 0.75rem 0;
  }
  .sidebar-filters .btn-primary {
    background: #232d4b;
    border: none;
  }
  .sidebar-filters .btn-primary:hover {
    background: #1a2136;
  }
</style>
<div class="container-fluid py-4">
  <div class="row">
    <!-- Sidebar Filters -->
    <aside class="col-md-3 mb-4">
      <div class="sidebar-filters">
        <h2 class="fw-bold mb-4">Filters</h2>
        <div class="accordion" id="filtersAccordion">
          <!-- Date -->
          <div class="accordion-item mb-2">
            <h2 class="accordion-header" id="headingDate">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseDate" aria-expanded="false" aria-controls="collapseDate">
                Date
              </button>
            </h2>
            <div id="collapseDate" class="accordion-collapse collapse" aria-labelledby="headingDate" data-bs-parent="#filtersAccordion">
              <div class="accordion-body">
                <div class="mb-3">
                  <label for="start_date" class="form-label">Start Date</label>
                  <input type="date" class="form-control" id="start_date" name="start_date">
                </div>
                <div>
                  <label for="end_date" class="form-label">End Date</label>
                  <input type="date" class="form-control" id="end_date" name="end_date">
                </div>
              </div>
            </div>
          </div>
          <!-- Geography -->
          <div class="accordion-item mb-2">
            <h2 class="accordion-header" id="headingGeography">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseGeography" aria-expanded="false" aria-controls="collapseGeography">
                Geography
              </button>
            </h2>
            <div id="collapseGeography" class="accordion-collapse collapse" aria-labelledby="headingGeography" data-bs-parent="#filtersAccordion">
              <div class="accordion-body">
                <div class="form-check mb-2">
                  <input class="form-check-input" type="checkbox" id="freq1">
                  <label class="form-check-label" for="freq1">Frequency</label>
                </div>
                <div class="form-check mb-2">
                  <input class="form-check-input" type="checkbox" id="freq2">
                  <label class="form-check-label" for="freq2">{Category}</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="freq3">
                  <label class="form-check-label" for="freq3">{Category}</label>
                </div>
              </div>
            </div>
          </div>
          <!-- Provenance -->
          <div class="accordion-item mb-2">
            <h2 class="accordion-header" id="headingProvenance">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseProvenance" aria-expanded="false" aria-controls="collapseProvenance">
                Provenance
              </button>
            </h2>
            <div id="collapseProvenance" class="accordion-collapse collapse" aria-labelledby="headingProvenance" data-bs-parent="#filtersAccordion">
              <div class="accordion-body">
                <select class="form-select" id="bandwidthSelect">
                  <option value="">Select Bandwidth</option>
                  <option value="1">1 MHz</option>
                  <option value="2">2 MHz</option>
                  <option value="5">5 MHz</option>
                  <option value="10">10 MHz</option>
                </select>
              </div>
            </div>
          </div>
          <!-- Authenticity -->
          <div class="accordion-item">
            <h2 class="accordion-header" id="headingAuthenticity">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAuthenticity" aria-expanded="false" aria-controls="collapseAuthenticity">
                Authenticity
              </button>
            </h2>
            <div id="collapseAuthenticity" class="accordion-collapse collapse" aria-labelledby="headingAuthenticity" data-bs-parent="#filtersAccordion">
              <div class="accordion-body">
                <select class="form-select" id="locationSelect">
                  <option value="">Select Location</option>
                  <option value="indoor">Indoor</option>
                  <option value="outdoor">Outdoor</option>
                </select>
              </div>
            </div>
          </div>
        </div>
        <div class="d-flex gap-3 mt-4">
          <button class="btn btn-primary flex-fill" type="submit">Apply Filters</button>
          <button class="btn btn-primary flex-fill" type="button">Clear Filters</button>
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="col-md-9">
      <!-- Search Bar -->
      <form class="input-group mb-3" method="get">
        <input type="text" class="form-control" placeholder="Search captures..." name="search" value="{{ request.GET.search|default_if_none:'' }}">
        <button class="btn btn-outline-secondary" type="submit">Search</button>
        {% if request.GET.search %}
          <a href="{% url 'users:file_list' %}" class="btn btn-outline-danger">Clear</a>
        {% endif %}
      </form>

      <!-- Captures Table -->
      <div class="card">
        <div class="card-body p-0">
          <div class="table-responsive" style="max-height: 60vh; overflow-y: auto;">
            <table class="table table-hover align-middle mb-0">
              <thead class="table-light">
                <tr>
                  <th scope="col">Channel</th>
                  <th scope="col">Capture Type</th>
                  <th scope="col">Created At</th>
                </tr>
              </thead>
              <tbody>
                {% if captures %}
                  {% for cap in captures %}
                  <tr>
                    <td>{{ cap.channel }}</td>
                    <td>{{ cap.capture_type }}</td>
                    <td>{{ cap.created_at|date:"Y-m-d H:i:s" }}</td>
                  </tr>
                  {% endfor %}
                {% else %}
                  <tr>
                    <td colspan="3" class="text-center text-muted py-4">No captures found.</td>
                  </tr>
                {% endif %}
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Pagination -->
      {% if captures %}
      <nav class="mt-3" aria-label="Page navigation">
        <ul class="pagination justify-content-center">
          {% if captures.has_previous %}
          <li class="page-item">
            <a class="page-link" href="?page={{ captures.previous_page_number }}&search={{ request.GET.search }}">Previous</a>
          </li>
          {% endif %}
          {% for num in captures.paginator.page_range %}
          <li class="page-item {% if num == captures.number %}active{% endif %}">
            <a class="page-link" href="?page={{ num }}&search={{ request.GET.search }}">{{ num }}</a>
          </li>
          {% endfor %}
          {% if captures.has_next %}
          <li class="page-item">
            <a class="page-link" href="?page={{ captures.next_page_number }}&search={{ request.GET.search }}">Next</a>
          </li>
          {% endif %}
        </ul>
      </nav>
      {% endif %}
    </main>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}
